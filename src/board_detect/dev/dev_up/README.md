# 核心开发脚本演进说明 (README)

## 概述

本文件旨在说明 `scripts_old` 目录中最核心的五个脚本之间的逻辑递进关系。它们共同构成了一条清晰的开发路径，从最基础的算法验证，到逐步叠加功能模块，最终形成一个稳定、完整的解决方案。

理解这个过程对于调试和二次开发至关重要。

---

## 开发流程：从地基到封顶

这五个脚本的演进关系可以看作是“盖房子”的过程，每一步都建立在前一步验证成功的基础之上。

### 步骤 1: `1_show_all_clusters.py` - **算法地基**

*   **目的**: 验证核心的 **“线拟合与偏差”聚类算法** 是否有效。
*   **功能**: 将激光雷达扫描到的所有点，通过该算法分割成不同的聚类（线段），并用不同颜色在RVIZ中画出来，以便直观评估算法效果。
*   **角色**: 纯粹的 **算法验证器**。它是所有后续工作的基础，确保了我们用来识别“板”的底层工具是可靠的。

### 步骤 2: `2_show_part_clusters.py` - **添加长度筛选**

*   **继承**: `1_show_all_clusters.py` 的聚类算法。
*   **新增**: **长度筛选** 逻辑。
*   **功能**: 在所有识别出的线段中，只显示那些长度在预设范围（如0.50-0.65米）内的部分。
*   **角色**: **长度筛选逻辑的调试器**。用于确认我们能否准确地从所有聚类中找到尺寸合适的“板”。

### 步骤 3: `3_show_roi_clusters.py` - **添加区域筛选**

*   **继承**: `2_show_part_clusters.py` 的逻辑（聚类 + 长度筛选）。
*   **新增**: **ROI（感兴趣区域）筛选** 逻辑。
*   **功能**: 只显示那些通过了长度筛选，并且完全位于指定矩形区域内的线段。同时，它也会将ROI区域的边界画出来，方便对照。
*   **角色**: **ROI筛选逻辑的调试器**。用于确认我们能否排除掉非目标区域的干扰。

### 步骤 4: `4_show_goals.py` - **添加目标点计算**

*   **继承**: `3_show_roi_clusters.py` 的完整筛选逻辑。
*   **新增**: **导航目标点（Goal）** 的计算、可视化和特定目标过滤功能。
*   **功能**: 为每一个通过所有筛选的“板”，计算出一个精确的导航位姿（位置+朝向），并在RVIZ中用箭头显示。
*   **角色**: **单帧处理流程的“全功能预览版”**。到这一步，单次扫描的所有核心计算逻辑都已开发和验证完毕。

### 步骤 5: `5_radar.py` - **最终方案集成与强化**

*   **继承**: `4_show_goals.py` 的完整单帧计算逻辑。
*   **新增**: **多帧处理**、**目标跟踪**、**位姿平均**、**结果保存为YAML文件**。
*   **功能**: 通过连续处理多帧数据并对结果进行平均，输出了极其稳定、精确的目标位姿，并将其保存为可直接被ROS导航系统使用的标准YAML文件。
*   **角色**: **最终交付方案的原型**。它是所有调试成果的集大成者，其稳定性和健壮性逻辑被直接应用到了生产脚本 `../scripts/board_detect.py` 中。

---

## 如何使用这些脚本进行调试

-   **怀疑聚类算法有问题？** -> 运行 `1_show_all_clusters.py` 查看所有原始聚类。
-   **检测到的物体尺寸不对？** -> 运行 `2_show_part_clusters.py` 检查长度筛选结果。
-   **检测到目标区域外的物体？** -> 运行 `3_show_roi_clusters.py` 检查ROI筛选结果。
-   **生成的导航箭头位置或朝向不对？** -> 运行 `4_show_goals.py` 检查单帧目标点计算。
-   **需要验证最终的、包含多帧平均的完整逻辑？** -> 运行 `5_radar.py`。