<launch>
    <!-- 启动激光雷达驱动节点 -->
    <include file="$(find ydlidar)/launch/ydlidar.launch" />

    <!-- 启动底盘控制节点 -->
    <include file="$(find ucar_controller)/launch/base_driver.launch" />

    <!-- 加载机器人URDF模型描述 -->
    <param name="robot_description" textfile="$(find ucar_nav)/urdf/xfcar.urdf" />

    <!-- 机器人状态发布 -->
    <node pkg="joint_state_publisher" name="joint_state_publisher" type="joint_state_publisher" />
    <node pkg="robot_state_publisher" type="robot_state_publisher" name="robot_state_publisher" />
    
    <!-- 启动 Gmapping 建图节点 -->
    <node pkg="gmapping" type="slam_gmapping" name="slam_gmapping" output="screen">
        <!-- 坐标系配置 -->
        <param name="base_frame" value="base_link"/>  <!-- 机器人基座坐标系 -->
        <param name="map_frame" value="map"/>             <!-- 地图坐标系 -->
        <param name="odom_frame" value="odom"/>           <!-- 里程计坐标系 -->

        <!-- 激光雷达参数 -->
        <param name="maxUrange" value="5.0"/>            <!-- Gmapping建图时 使用的激光雷达的距离(米)，默认80.0 -->
        <param name="maxRange" value="16.0"/>             <!-- 激光雷达最大范围(米) -->
        <param name="lskip" value="0"/>                   <!-- 跳过的激光束数量，默认0 -->
        <param name="throttle_scans" value="1"/>          <!-- 处理激光扫描的速率，默认1 -->

        <!-- 地图更新参数 -->
        <param name="map_update_interval" value="1.0"/>   <!-- 地图更新频率(秒)，默认5.0 -->
        <param name="linearUpdate" value="0.1"/>          <!-- 机器人移动0.1米更新一次地图，默认1.0 -->
        <param name="angularUpdate" value="0.2"/>         <!-- 机器人旋转0.2弧度更新一次地图，默认0.5 -->
      
        <!-- 粒子数参数 -->
        <param name="particles" value="200" />              <!-- 默认粒子数为30，可根据需要修改 -->
    
    </node>

    <!-- 启动键盘控制节点 -->
    <node pkg="teleop_twist_keyboard" type="teleop_twist_keyboard.py" 
          name="teleop_keyboard" output="screen">
          
        <!-- 设置初始/最大线速度 (单位: 米/秒，根据你的需求修改 value) -->
        <param name="speed" value="0.15" /> 
        
        <!-- 设置初始/最大角速度 (单位: 弧度/秒，根据你的需求修改 value) -->
        <param name="turn" value="0.5" />       
    </node>

</launch>